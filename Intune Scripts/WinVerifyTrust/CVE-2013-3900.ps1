function CheckKey ($Path, $Name, $Value) {
    $Exists = (Get-ItemProperty $Path).PSObject.Properties.Name -contains $Name
    If ($Exists) {
        Set-ItemProperty -Path $Path -Name $Name -Value $Value -Type DWORD -Force
    } else {
        New-Item -Path $Path -Force
        New-ItemProperty -Path $Path -Name $Name -Value $Value -PropertyType DWORD -Force
    }
}

$64BitRegistryPath = 'HKLM:\Software\Microsoft\Cryptography\Wintrust\Config'
$32BitRegistryPath = 'HKLM:\Software\WOW6432Node\Microsoft\Cryptography\Wintrust\Config'
$RegKeyName = 'EnableCertPaddingCheck'
$RegKeyValue = '1'

CheckKey $64BitRegistryPath $RegKeyName $RegKeyValue
CheckKey $32BitRegistryPath $RegKeyName $RegKeyValue
